metric.counter:
    ads_rmp_requests:                       {filter: [eventtype_ext: 3963]}
    ads_rmp_errors:                         {filter: [eventtype_ext: 3964]}
    ads_requests:                           {filter: [eventtype_ext: 3967]}
    ads_requests_credit:                    {filter: [eventtype_ext: 3967, banner_code: ['btni', 'ads_mob_credit_btn', 'app']]}
    ads_requests_search:                    {filter: [eventtype_ext: 3967, banner_code: ['context_1', 'context_12', 'context_15', 'context_7', 'tile_1', 'tile_2', 'ads_direct_low', 'ads_direct_top', 'ads_mob_central', 'ads_mob_mid', 'ads_mob_mid3', 'app_search_10', 'app_search_17', 'app_search_24', 'app_search_30', 'app_search_4', 'app_search_7', 'app_search_13', 'app_search_14']]}
    ads_requests_item:                      {filter: [eventtype_ext: 3967, banner_code: ['item_mid', 'ldr_top', 'tgb2', 'wl', 'ads_item_mob_top', 'ads_mob_low', 'item_atf_android', 'item_btf_android', 'item_btf_ios']]}
    ads_requests_main:                      {filter: [eventtype_ext: 3967, banner_code: ['desktop_mimicry', 'serp_low', 'serp_top', 'mobile_main', 'mobile_main_top', 'root_rnd_android', 'root_top_android', 'root_rnd_ios', 'root_top_ios']]}
    ads_requests_messenger:                 {filter: [eventtype_ext: 3967, banner_code: ['messenger_ad_android', 'messenger_ad_ios']]}
    ads_passbacks:                          {filter: [eventtype_ext: 3969]}
    ad_fails:                               {filter: [eventtype_ext: 3250]}
    ads_full_renders:                       {filter: [eventtype_ext: 3970], m42: False}
    ads_full_renders_credit:                {filter: [eventtype_ext: 3970, banner_code: ['btni', 'ads_mob_credit_btn', 'app']], m42: False}
    ads_full_renders_search:                {filter: [eventtype_ext: 3970, banner_code: ['context_1', 'context_12', 'context_15', 'context_7', 'tile_1', 'tile_2', 'ads_direct_low', 'ads_direct_top', 'ads_mob_central', 'ads_mob_mid', 'ads_mob_mid3', 'app_search_10', 'app_search_17', 'app_search_24', 'app_search_30', 'app_search_4', 'app_search_7', 'app_search_13', 'app_search_14']], m42: False}
    ads_full_renders_item:                  {filter: [eventtype_ext: 3970, banner_code: ['item_mid', 'ldr_top', 'tgb2', 'wl', 'ads_item_mob_top', 'ads_mob_low', 'item_atf_android', 'item_btf_android', 'item_btf_ios']], m42: False}
    ads_full_renders_main:                  {filter: [eventtype_ext: 3970, banner_code: ['desktop_mimicry', 'serp_low', 'serp_top', 'mobile_main', 'mobile_main_top', 'root_rnd_android', 'root_top_android', 'root_rnd_ios', 'root_top_ios']], m42: False}
    ads_full_renders_messenger:             {filter: [eventtype_ext: 3970, banner_code: ['messenger_ad_android', 'messenger_ad_ios']], m42: False}
    ads_full_views:                         {filter: [eventtype_ext: 3968], m42: False}
    ads_full_views_credit:                  {filter: [eventtype_ext: 3968, banner_code: ['btni', 'ads_mob_credit_btn', 'app']], m42: False}
    ads_full_views_search:                  {filter: [eventtype_ext: 3968, banner_code: ['context_1', 'context_12', 'context_15', 'context_7', 'tile_1', 'tile_2', 'ads_direct_low', 'ads_direct_top', 'ads_mob_central', 'ads_mob_mid', 'ads_mob_mid3', 'app_search_10', 'app_search_17', 'app_search_24', 'app_search_30', 'app_search_4', 'app_search_7', 'app_search_13', 'app_search_14']], m42: False}
    ads_full_views_item:                    {filter: [eventtype_ext: 3968, banner_code: ['item_mid', 'ldr_top', 'tgb2', 'wl', 'ads_item_mob_top', 'ads_mob_low', 'item_atf_android', 'item_btf_android', 'item_btf_ios']], m42: False}
    ads_full_views_main:                    {filter: [eventtype_ext: 3968, banner_code: ['desktop_mimicry', 'serp_low', 'serp_top', 'mobile_main', 'mobile_main_top', 'root_rnd_android', 'root_top_android', 'root_rnd_ios', 'root_top_ios']], m42: False}
    ads_full_views_messenger:               {filter: [eventtype_ext: 3968, banner_code: ['messenger_ad_android', 'messenger_ad_ios']], m42: False}
    ad_clicks:                              {filter: [eventtype_ext: 3215]}
    ad_clicks_credit:                       {filter: [eventtype_ext: 3215, banner_code: ['btni', 'ads_mob_credit_btn', 'app']]}
    ad_clicks_search:                       {filter: [eventtype_ext: 3215, banner_code: ['context_1', 'context_12', 'context_15', 'context_7', 'tile_1', 'tile_2', 'ads_direct_low', 'ads_direct_top', 'ads_mob_central', 'ads_mob_mid', 'ads_mob_mid3', 'app_search_10', 'app_search_17', 'app_search_24', 'app_search_30', 'app_search_4', 'app_search_7', 'app_search_13', 'app_search_14']]}
    ad_clicks_item:                         {filter: [eventtype_ext: 3215, banner_code: ['item_mid', 'ldr_top', 'tgb2', 'wl', 'ads_item_mob_top', 'ads_mob_low', 'item_atf_android', 'item_btf_android', 'item_btf_ios']]}
    ad_clicks_main:                         {filter: [eventtype_ext: 3215, banner_code: ['desktop_mimicry', 'serp_low', 'serp_top', 'mobile_main', 'mobile_main_top', 'root_rnd_android', 'root_top_android', 'root_rnd_ios', 'root_top_ios']]}
    ad_clicks_messenger:                    {filter: [eventtype_ext: 3215, banner_code: ['messenger_ad_android', 'messenger_ad_ios']]}
    ads_full_inventory:                     {filter: [eventtype_ext: 3967, reqnum: 1], m42: False}
    ads_full_inventory_credit:              {filter: [eventtype_ext: 3967, reqnum: 1, banner_code: ['btni', 'ads_mob_credit_btn', 'app']], m42: False}
    ads_full_inventory_search:              {filter: [eventtype_ext: 3967, reqnum: 1, banner_code: ['context_1', 'context_12', 'context_15', 'context_7', 'tile_1', 'tile_2', 'ads_direct_low', 'ads_direct_top', 'ads_mob_central', 'ads_mob_mid', 'ads_mob_mid3', 'app_search_10', 'app_search_17', 'app_search_24', 'app_search_30', 'app_search_4', 'app_search_7', 'app_search_13', 'app_search_14']], m42: False}
    ads_full_inventory_item:                {filter: [eventtype_ext: 3967, reqnum: 1, banner_code: ['item_mid', 'ldr_top', 'tgb2', 'wl', 'ads_item_mob_top', 'ads_mob_low', 'item_atf_android', 'item_btf_android', 'item_btf_ios']], m42: False}
    ads_full_inventory_main:                {filter: [eventtype_ext: 3967, reqnum: 1, banner_code: ['desktop_mimicry', 'serp_low', 'serp_top', 'mobile_main', 'mobile_main_top', 'root_rnd_android', 'root_top_android', 'root_rnd_ios', 'root_top_ios']], m42: False}
    ads_full_inventory_messenger:           {filter: [eventtype_ext: 3967, reqnum: 1, banner_code: ['messenger_ad_android', 'messenger_ad_ios']], m42: False}
    ads_sum_waterfall_depth:                {filter: [eventtype_ext: 3967, reqnum: $max_reqnum], obs: [reqnum], m42: False}
    ads_requests_max_num:                   {filter: [eventtype_ext: 3967, reqnum: $max_reqnum], m42: False}
    ads_sum_requests_time:                  {filter: [eventtype_ext: 3967, cdtm: $min_cdtm], obs: [cdtm], m42: False}
    ads_sum_renders_time:                   {filter: [eventtype_ext: 3970, cdtm: $min_cdtm], obs: [cdtm], m42: False}
    ads_sum_views_time:                     {filter: [eventtype_ext: 3968, cdtm: $min_cdtm], obs: [cdtm], m42: False}
    ads_sum_clicks_time:                    {filter: [eventtype_ext: 3215, cdtm: $min_cdtm], obs: [cdtm], m42: False}
    ads_requests_for_time:                  {filter: [eventtype_ext: 3967, cdtm: $min_cdtm], m42: False}
    ads_renders_for_time:                   {filter: [eventtype_ext: 3970, cdtm: $min_cdtm], m42: False}
    ads_views_for_time:                     {filter: [eventtype_ext: 3968, cdtm: $min_cdtm], m42: False}
    ads_clicks_for_time:                    {filter: [eventtype_ext: 3215, cdtm: $min_cdtm], m42: False}

metric.uniq:
    ads_renders:                            {counter: ads_full_renders,             key: [alid_id]}
    ads_renders_credit:                     {counter: ads_full_renders_credit,      key: [alid_id]}
    ads_renders_search:                     {counter: ads_full_renders_search,      key: [alid_id]}
    ads_renders_item:                       {counter: ads_full_renders_item,        key: [alid_id]}
    ads_renders_main:                       {counter: ads_full_renders_main,        key: [alid_id]}
    ads_renders_messenger:                  {counter: ads_full_renders_messenger,   key: [alid_id]}
    ads_views:                              {counter: ads_full_views,               key: [alid_id]}
    ads_views_credit:                       {counter: ads_full_views_credit,        key: [alid_id]}
    ads_views_search:                       {counter: ads_full_views_search,        key: [alid_id]}
    ads_views_item:                         {counter: ads_full_views_item,          key: [alid_id]}
    ads_views_main:                         {counter: ads_full_views_main,          key: [alid_id]}
    ads_views_messenger:                    {counter: ads_full_views_messenger,     key: [alid_id]}
    ads_inventory:                          {counter: ads_full_inventory,           key: [alid_id]}
    ads_inventory_credit:                   {counter: ads_full_inventory_credit,    key: [alid_id]}
    ads_inventory_search:                   {counter: ads_full_inventory_search,    key: [alid_id]}
    ads_inventory_item:                     {counter: ads_full_inventory_item,      key: [alid_id]}
    ads_inventory_main:                     {counter: ads_full_inventory_main,      key: [alid_id]}
    ads_inventory_messenger:                {counter: ads_full_inventory_messenger, key: [alid_id]}

metric.ratio:
    ads_waterfall_depth:                    {num: ads_sum_waterfall_depth,      den: ads_requests_max_num}
    ads_requests_time:                      {num: ads_sum_requests_time,        den: ads_requests_for_time}
    ads_renders_time:                       {num: ads_sum_renders_time,         den: ads_renders_for_time}
    ads_views_time:                         {num: ads_sum_views_time,           den: ads_views_for_time}
    ads_clicks_time:                        {num: ads_sum_clicks_time,          den: ads_clicks_for_time}
    ads_viewability:                        {num: ads_views,                    den: ads_renders}
    ads_vctr:                               {num: ad_clicks,                    den: ads_views}
    ads_request_renders_ratio:              {num: ads_renders,                  den: ads_requests}
    ads_renders_views_ratio:                {num: ads_views,                    den: ads_renders }
    ads_views_cbutton_ratio:                {num: ads_views_credit,             den: ads_views}
