definitions:
  - &revenue   {isrevenue: true, is_classified: true}
  - &payment   {ispayment: true, is_classified: true}

metric.counter:
#revenue (amount)
  vas_amount:                              {obs: [amount],      filter: [*revenue, product_type: 'vas']}
  vas_amount_visual:                       {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'visual']}
  vas_amount_performance:                  {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'performance']}
  vas_amount_bundle:                       {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle']}
  vas_amount_x2_1:                         {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x2_1']}
  vas_amount_x2_7:                         {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x2_7']}
  vas_amount_x5_1:                         {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x5_1']}
  vas_amount_x5_7:                         {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x5_7']}
  vas_amount_x10_1:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x10_1']}
  vas_amount_x10_7:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x10_7']}
  vas_amount_x12_1:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x12_1']}
  vas_amount_x12_7:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x12_7']}
  vas_amount_x14_1:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x14_1']}
  vas_amount_x14_7:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x14_7']} 
  vas_amount_x15_1:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x15_1']}
  vas_amount_x15_7:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x15_7']}
  vas_amount_x16_1:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x16_1']}
  vas_amount_x16_7:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x16_7']}
  vas_amount_x18_1:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x18_1']}
  vas_amount_x18_7:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x18_7']}  
  vas_amount_x20_1:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x20_1']}
  vas_amount_x20_7:                        {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x20_7']}  
  vas_amount_highlight:                    {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'Highlight']}
  vas_amount_xl:                           {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'XL']}
  vas_amount_bundle_mid:                   {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'mid']}
  vas_amount_bundle_max:                   {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'max']}
#revenue (amount) start_date (items activated in AB test)
  vas_amount_start_date:                   {obs: [amount],      filter: [*revenue, product_type: 'vas', start_date.>=: $ab_start_date]}
  vas_amount_visual_start_date:            {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'visual', start_date.>=: $ab_start_date]}
  vas_amount_performance_start_date:       {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'performance', start_date.>=: $ab_start_date]}
  vas_amount_bundle_start_date:            {obs: [amount],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', start_date.>=: $ab_start_date]}
  vas_amount_highlight_start_date:         {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'Highlight', start_date.>=: $ab_start_date]}
  vas_amount_xl_start_date:                {obs: [amount],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'XL', start_date.>=: $ab_start_date]}
   #revenue (amount_net)
  vas_amount_net:                          {obs: [amount_net],      filter: [*revenue, product_type: 'vas']}
  vas_amount_net_visual:                   {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'visual']}
  vas_amount_net_performance:              {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'performance']}
  vas_amount_net_bundle:                   {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle']}
  vas_amount_net_x2_1:                     {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x2_1']}
  vas_amount_net_x2_7:                     {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x2_7']}
  vas_amount_net_x5_1:                     {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x5_1']}
  vas_amount_net_x5_7:                     {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x5_7']}
  vas_amount_net_x10_1:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x10_1']}
  vas_amount_net_x10_7:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x10_7']}
  vas_amount_net_x12_1:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x12_1']}
  vas_amount_net_x12_7:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x12_7']}
  vas_amount_net_x14_1:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x14_1']}
  vas_amount_net_x14_7:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x14_7']} 
  vas_amount_net_x15_1:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x15_1']}
  vas_amount_net_x15_7:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x15_7']}
  vas_amount_net_x16_1:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x16_1']}
  vas_amount_net_x16_7:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x16_7']}
  vas_amount_net_x18_1:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x18_1']}
  vas_amount_net_x18_7:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x18_7']}  
  vas_amount_net_x20_1:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x20_1']}
  vas_amount_net_x20_7:                    {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x20_7']}  
  vas_amount_net_highlight:                {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'Highlight']}
  vas_amount_net_xl:                       {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'XL']}
  vas_amount_net_bundle_mid:               {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'mid']}
  vas_amount_net_bundle_max:               {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'max']}
#revenue (amount_net)start_date (items activated in AB test) 
  vas_amount_net_start_date:                   {obs: [amount_net],      filter: [*revenue, product_type: 'vas', start_date.>=: $ab_start_date]}
  vas_amount_net_visual_start_date:            {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'visual', start_date.>=: $ab_start_date]}
  vas_amount_net_performance_start_date:       {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'performance', start_date.>=: $ab_start_date]}
  vas_amount_net_bundle_start_date:            {obs: [amount_net],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', start_date.>=: $ab_start_date]}
  vas_amount_net_highlight_start_date:         {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'Highlight', start_date.>=: $ab_start_date]}
  vas_amount_net_xl_start_date:                {obs: [amount_net],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'XL', start_date.>=: $ab_start_date]}
#clean reserved revenue (amount)
  vas_clean_reserved_amount:                              {obs: [amount],      filter: [*payment, product_type: 'vas']}
  vas_clean_reserved_amount_visual:                       {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'visual']}
  vas_clean_reserved_amount_performance:                  {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'performance']}
  vas_clean_reserved_amount_bundle:                       {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle']}
  vas_clean_reserved_amount_x2_1:                         {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x2_1']}
  vas_clean_reserved_amount_x2_7:                         {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x2_7']}
  vas_clean_reserved_amount_x5_1:                         {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x5_1']}
  vas_clean_reserved_amount_x5_7:                         {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x5_7']}
  vas_clean_reserved_amount_x10_1:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x10_1']}
  vas_clean_reserved_amount_x10_7:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x10_7']}
  vas_clean_reserved_amount_x12_1:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x12_1']}
  vas_clean_reserved_amount_x12_7:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x12_7']}
  vas_clean_reserved_amount_x14_1:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x14_1']}
  vas_clean_reserved_amount_x14_7:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x14_7']} 
  vas_clean_reserved_amount_x15_1:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x15_1']}
  vas_clean_reserved_amount_x15_7:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x15_7']}
  vas_clean_reserved_amount_x16_1:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x16_1']}
  vas_clean_reserved_amount_x16_7:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x16_7']}
  vas_clean_reserved_amount_x18_1:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x18_1']}
  vas_clean_reserved_amount_x18_7:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x18_7']}  
  vas_clean_reserved_amount_x20_1:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x20_1']}
  vas_clean_reserved_amount_x20_7:                        {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x20_7']}  
  vas_clean_reserved_amount_highlight:                    {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'Highlight']}
  vas_clean_reserved_amount_xl:                           {obs: [amount],      filter: [*payment, product_type: 'vas', transaction_subtype: 'XL']}
  vas_clean_reserved_amount_bundle_mid:                   {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'mid']}
  vas_clean_reserved_amount_bundle_max:                   {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'max']}
#clean reserved revenue (amount) start_date (items activated in AB test) 
  vas_clean_reserved_amount_start_date:                   {obs: [amount],      filter: [*payment, product_type: 'vas', start_date.>=: $ab_start_date]}
  vas_clean_reserved_amount_visual_start_date:            {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'visual', start_date.>=: $ab_start_date]}
  vas_clean_reserved_amount_performance_start_date:       {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'performance', start_date.>=: $ab_start_date]}
  vas_clean_reserved_amount_bundle_start_date:            {obs: [amount],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle', start_date.>=: $ab_start_date]}
 #clean reserved revenue (amount_net)
  vas_clean_reserved_amount_net:                          {obs: [amount_net],      filter: [*payment, product_type: 'vas']}
  vas_clean_reserved_amount_net_visual:                   {obs: [amount_net],      filter: [*payment, product_type: 'vas', product_subtype: 'visual']}
  vas_clean_reserved_amount_net_performance:              {obs: [amount_net],      filter: [*payment, product_type: 'vas', product_subtype: 'performance']}
  vas_clean_reserved_amount_net_bundle:                   {obs: [amount_net],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle']}
  vas_clean_reserved_amount_net_x2_1:                     {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x2_1']}
  vas_clean_reserved_amount_net_x2_7:                     {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x2_7']}
  vas_clean_reserved_amount_net_x5_1:                     {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x5_1']}
  vas_clean_reserved_amount_net_x5_7:                     {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x5_7']}
  vas_clean_reserved_amount_net_x10_1:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x10_1']}
  vas_clean_reserved_amount_net_x10_7:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x10_7']}
  vas_clean_reserved_amount_net_x12_1:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x12_1']}
  vas_clean_reserved_amount_net_x12_7:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x12_7']}
  vas_clean_reserved_amount_net_x14_1:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x14_1']}
  vas_clean_reserved_amount_net_x14_7:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x14_7']} 
  vas_clean_reserved_amount_net_x15_1:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x15_1']}
  vas_clean_reserved_amount_net_x15_7:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x15_7']}
  vas_clean_reserved_amount_net_x16_1:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x16_1']}
  vas_clean_reserved_amount_net_x16_7:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x16_7']}
  vas_clean_reserved_amount_net_x18_1:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x18_1']}
  vas_clean_reserved_amount_net_x18_7:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x18_7']}  
  vas_clean_reserved_amount_net_x20_1:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x20_1']}
  vas_clean_reserved_amount_net_x20_7:                    {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x20_7']}  
  vas_clean_reserved_amount_net_highlight:                {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'Highlight']}
  vas_clean_reserved_amount_net_xl:                       {obs: [amount_net],      filter: [*payment, product_type: 'vas', transaction_subtype: 'XL']}
  vas_clean_reserved_amount_net_bundle_mid:               {obs: [amount_net],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'mid']}
  vas_clean_reserved_amount_net_bundle_max:               {obs: [amount_net],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'max']}
#transactions (write off, burn)
  vas_transactions_mnz:                    {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas']}
  vas_transactions_mnz_visual:             {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'visual']}
  vas_transactions_mnz_performance:        {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'performance']}
  vas_transactions_mnz_bundle:             {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle']}
  vas_transactions_mnz_x2_1:               {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x2_1']}
  vas_transactions_mnz_x2_7:               {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x2_7']}
  vas_transactions_mnz_x5_1:               {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x5_1']}
  vas_transactions_mnz_x5_7:               {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x5_7']}
  vas_transactions_mnz_x10_1:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x10_1']}
  vas_transactions_mnz_x10_7:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x10_7']}
  vas_transactions_mnz_x12_1:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x12_1']}
  vas_transactions_mnz_x12_7:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x12_7']}
  vas_transactions_mnz_x14_1:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x14_1']}
  vas_transactions_mnz_x14_7:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x14_7']}
  vas_transactions_mnz_x15_1:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x15_1']}
  vas_transactions_mnz_x15_7:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x15_7']}
  vas_transactions_mnz_x16_1:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x16_1']}
  vas_transactions_mnz_x16_7:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x16_7']}
  vas_transactions_mnz_x18_1:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x18_1']}
  vas_transactions_mnz_x18_7:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x18_7']}
  vas_transactions_mnz_x20_1:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x20_1']}
  vas_transactions_mnz_x20_7:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'x20_7']}
  vas_transactions_highlight:              {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'Highlight']}
  vas_transactions_xl:                     {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'XL']}
  vas_transactions_mnz_bundle_mid:         {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'mid']}
  vas_transactions_mnz_bundle_max:         {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'max']}
#transactions (write off, burn) start_date
  vas_transactions_start_date:             {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', start_date.>=: $ab_start_date]}
  vas_transactions_visual_start_date:      {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'visual',        start_date.>=: $ab_start_date]}
  vas_transactions_performance_start_date: {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'performance',   start_date.>=: $ab_start_date]}
  vas_transactions_bundle_start_date:      {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', product_subtype: 'bundle',        start_date.>=: $ab_start_date]}
  vas_transactions_highlight_start_date:   {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'Highlight', start_date.>=: $ab_start_date]}
  vas_transactions_xl_start_date:          {obs: [transaction_counter],      filter: [*revenue, product_type: 'vas', transaction_subtype: 'XL',        start_date.>=: $ab_start_date]}
# reserve transactions
  vas_reserve_transactions:                    {obs: [transaction_counter],      filter: [*payment, product_type: 'vas']}
  vas_reserve_transactions_visual:             {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'visual']}
  vas_reserve_transactions_performance:        {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'performance']}
  vas_reserve_transactions_bundle:             {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle']}
  vas_reserve_transactions_x2_1:               {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x2_1']}
  vas_reserve_transactions_x2_7:               {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x2_7']}
  vas_reserve_transactions_x5_1:               {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x5_1']}
  vas_reserve_transactions_x5_7:               {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x5_7']}
  vas_reserve_transactions_x10_1:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x10_1']}
  vas_reserve_transactions_x10_7:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x10_7']}
  vas_reserve_transactions_x12_1:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x12_1']}
  vas_reserve_transactions_x12_7:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x12_7']}
  vas_reserve_transactions_x14_1:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x14_1']}
  vas_reserve_transactions_x14_7:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x14_7']}
  vas_reserve_transactions_x15_1:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x15_1']}
  vas_reserve_transactions_x15_7:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x15_7']}
  vas_reserve_transactions_x16_1:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x16_1']}
  vas_reserve_transactions_x16_7:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x16_7']}
  vas_reserve_transactions_x18_1:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x18_1']}
  vas_reserve_transactions_x18_7:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x18_7']}
  vas_reserve_transactions_x20_1:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x20_1']}
  vas_reserve_transactions_x20_7:              {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'x20_7']}
  vas_reserve_transactions_highlight:          {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'Highlight']}
  vas_reserve_transactions_xl:                 {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'XL']}
  vas_reserve_transactions_bundle_mid:         {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'mid']}
  vas_reserve_transactions_bundle_max:         {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle', transaction_subtype: 'max']}
# reserve transactions (start_date)
  vas_reserve_transactions_start_date:             {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', start_date.>=: $ab_start_date]}
  vas_reserve_transactions_visual_start_date:      {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'visual',        start_date.>=: $ab_start_date]}
  vas_reserve_transactions_performance_start_date: {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'performance',   start_date.>=: $ab_start_date]}
  vas_reserve_transactions_bundle_start_date:      {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', product_subtype: 'bundle',        start_date.>=: $ab_start_date]}
  vas_reserve_transactions_highlight_start_date:   {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'Highlight', start_date.>=: $ab_start_date]}
  vas_reserve_transactions_xl_start_date:          {obs: [transaction_counter],      filter: [*payment, product_type: 'vas', transaction_subtype: 'XL',        start_date.>=: $ab_start_date]}


metric.uniq:
  users_vas:                               {counter: vas_amount_net,                  key: [user]}
  users_vas_visual:                        {counter: vas_amount_net_visual,           key: [user]}
  users_vas_bundle:                        {counter: vas_amount_net_bundle,           key: [user]}
  users_vas_performance:                   {counter: vas_amount_net_performance,      key: [user]}
  users_vas_x2_1:                          {counter: vas_amount_net_x2_1,             key: [user]}
  users_vas_x2_7:                          {counter: vas_amount_net_x2_7,             key: [user]}
  users_vas_x5_1:                          {counter: vas_amount_net_x5_1,             key: [user]}
  users_vas_x5_7:                          {counter: vas_amount_net_x5_7,             key: [user]}
  users_vas_x10_1:                         {counter: vas_amount_net_x10_1,            key: [user]}
  users_vas_x10_7:                         {counter: vas_amount_net_x10_7,            key: [user]}
  users_vas_x12_1:                         {counter: vas_amount_net_x12_1,            key: [user]}
  users_vas_x12_7:                         {counter: vas_amount_net_x12_7,            key: [user]}
  users_vas_x14_1:                         {counter: vas_amount_net_x14_1,            key: [user]}
  users_vas_x14_7:                         {counter: vas_amount_net_x14_7,            key: [user]}
  users_vas_x15_1:                         {counter: vas_amount_net_x15_1,            key: [user]}
  users_vas_x15_7:                         {counter: vas_amount_net_x15_7,            key: [user]}
  users_vas_x16_1:                         {counter: vas_amount_net_x16_1,            key: [user]}
  users_vas_x16_7:                         {counter: vas_amount_net_x16_7,            key: [user]}
  users_vas_x18_1:                         {counter: vas_amount_net_x18_1,            key: [user]}
  users_vas_x18_7:                         {counter: vas_amount_net_x18_7,            key: [user]}
  users_vas_x20_1:                         {counter: vas_amount_net_x20_1,            key: [user]}
  users_vas_x20_7:                         {counter: vas_amount_net_x20_7,            key: [user]}
  users_vas_highlight:                     {counter: vas_amount_net_highlight,        key: [user]}
  users_vas_xl:                            {counter: vas_amount_net_xl,               key: [user]}
  users_vas_bundle_mid:                    {counter: vas_amount_net_bundle_mid,       key: [user]}
  users_vas_bundle_max:                    {counter: vas_amount_net_bundle_max,       key: [user]}
#users start_date
  users_vas_start_date:                               {counter: vas_amount_net_start_date,                  key: [user]}
  users_vas_visual_start_date:                        {counter: vas_amount_net_visual_start_date,           key: [user]}
  users_vas_bundle_start_date:                        {counter: vas_amount_net_bundle_start_date,           key: [user]}
  users_vas_performance_start_date_start_date:        {counter: vas_amount_net_performance_start_date,      key: [user]}
  users_vas_xl_start_date:                            {counter: vas_amount_net_xl_start_date,               key: [user]} 
  users_vas_highlight_start_date:                     {counter: vas_amount_net_highlight_start_date,        key: [user]}  

metric.ratio:
  vas_avo:                                 {num: vas_amount,                      den: vas_transactions_mnz}
  vas_avo_visual:                          {num: vas_amount_visual,               den: vas_transactions_mnz_visual}
  vas_avo_performance:                     {num: vas_amount_performance,          den: vas_transactions_mnz_performance}
  vas_avo_bundle:                          {num: vas_amount_bundle,               den: vas_transactions_mnz_bundle}
  vas_avo_x2_1:                            {num: vas_amount_x2_1,                 den: vas_transactions_mnz_x2_1}
  vas_avo_x2_7:                            {num: vas_amount_x2_7,                 den: vas_transactions_mnz_x2_7}
  vas_avo_x5_1:                            {num: vas_amount_x5_1,                 den: vas_transactions_mnz_x5_1}
  vas_avo_x5_7:                            {num: vas_amount_x5_7,                 den: vas_transactions_mnz_x5_7}
  vas_avo_x10_1:                           {num: vas_amount_x10_1,                den: vas_transactions_mnz_x10_1}
  vas_avo_x10_7:                           {num: vas_amount_x10_7,                den: vas_transactions_mnz_x10_7}
  vas_avo_x12_1:                           {num: vas_amount_x12_1,                den: vas_transactions_mnz_x12_1}
  vas_avo_x12_7:                           {num: vas_amount_x12_7,                den: vas_transactions_mnz_x12_7}
  vas_avo_x14_1:                           {num: vas_amount_x14_1,                den: vas_transactions_mnz_x14_1}
  vas_avo_x14_7:                           {num: vas_amount_x14_7,                den: vas_transactions_mnz_x14_7}
  vas_avo_x15_1:                           {num: vas_amount_x15_1,                den: vas_transactions_mnz_x15_1}
  vas_avo_x15_7:                           {num: vas_amount_x15_7,                den: vas_transactions_mnz_x15_7}
  vas_avo_x16_1:                           {num: vas_amount_x16_1,                den: vas_transactions_mnz_x16_1}
  vas_avo_x16_7:                           {num: vas_amount_x16_7,                den: vas_transactions_mnz_x16_7}
  vas_avo_x18_1:                           {num: vas_amount_x18_1,                den: vas_transactions_mnz_x18_1}
  vas_avo_x18_7:                           {num: vas_amount_x18_7,                den: vas_transactions_mnz_x18_7}
  vas_avo_x20_1:                           {num: vas_amount_x20_1,                den: vas_transactions_mnz_x20_1}
  vas_avo_x20_7:                           {num: vas_amount_x20_7,                den: vas_transactions_mnz_x20_7}
  vas_avo_highlight:                       {num: vas_amount_highlight,            den: vas_transactions_highlight}
  vas_avo_xl:                              {num: vas_amount_xl,                   den: vas_transactions_xl}
  vas_avo_bundle_mid:                      {num: vas_amount_bundle_mid,           den: vas_transactions_mnz_bundle_mid}
  vas_avo_bundle_max:                      {num: vas_amount_bundle_max,           den: vas_transactions_mnz_bundle_max}
#avo start_date
  vas_avo_start_date:                                 {num: vas_amount_start_date,                      den: vas_transactions_start_date}
  vas_avo_visual_start_date:                          {num: vas_amount_visual_start_date,               den: vas_transactions_visual_start_date}
  vas_avo_performance_start_date:                     {num: vas_amount_performance_start_date,          den: vas_transactions_performance_start_date}
  vas_avo_bundle_start_date:                          {num: vas_amount_bundle_start_date,               den: vas_transactions_bundle_start_date}
  vas_avo_highlight_start_date:                       {num: vas_amount_highlight_start_date,            den: vas_transactions_highlight_start_date}
  vas_avo_xl_start_date:                              {num: vas_amount_xl_start_date,                   den: vas_transactions_xl_start_date}
#avo_net
  vas_avo_net:                                 {num: vas_amount_net,                  den: vas_transactions_mnz}
  vas_avo_net_visual:                          {num: vas_amount_net_visual,               den: vas_transactions_mnz_visual}
  vas_avo_net_performance:                     {num: vas_amount_net_performance,          den: vas_transactions_mnz_performance}
  vas_avo_net_bundle:                          {num: vas_amount_net_bundle,               den: vas_transactions_mnz_bundle}
  vas_avo_net_x2_1:                            {num: vas_amount_net_x2_1,                 den: vas_transactions_mnz_x2_1}
  vas_avo_net_x2_7:                            {num: vas_amount_net_x2_7,                 den: vas_transactions_mnz_x2_7}
  vas_avo_net_x5_1:                            {num: vas_amount_net_x5_1,                 den: vas_transactions_mnz_x5_1}
  vas_avo_net_x5_7:                            {num: vas_amount_net_x5_7,                 den: vas_transactions_mnz_x5_7}
  vas_avo_net_x10_1:                           {num: vas_amount_net_x10_1,                den: vas_transactions_mnz_x10_1}
  vas_avo_net_x10_7:                           {num: vas_amount_net_x10_7,                den: vas_transactions_mnz_x10_7}
  vas_avo_net_x12_1:                           {num: vas_amount_net_x12_1,                den: vas_transactions_mnz_x12_1}
  vas_avo_net_x12_7:                           {num: vas_amount_net_x12_7,                den: vas_transactions_mnz_x12_7}
  vas_avo_net_x14_1:                           {num: vas_amount_net_x14_1,                den: vas_transactions_mnz_x14_1}
  vas_avo_net_x14_7:                           {num: vas_amount_net_x14_7,                den: vas_transactions_mnz_x14_7}
  vas_avo_net_x15_1:                           {num: vas_amount_net_x15_1,                den: vas_transactions_mnz_x15_1}
  vas_avo_net_x15_7:                           {num: vas_amount_net_x15_7,                den: vas_transactions_mnz_x15_7}
  vas_avo_net_x16_1:                           {num: vas_amount_net_x16_1,                den: vas_transactions_mnz_x16_1}
  vas_avo_net_x16_7:                           {num: vas_amount_net_x16_7,                den: vas_transactions_mnz_x16_7}
  vas_avo_net_x18_1:                           {num: vas_amount_net_x18_1,                den: vas_transactions_mnz_x18_1}
  vas_avo_net_x18_7:                           {num: vas_amount_net_x18_7,                den: vas_transactions_mnz_x18_7}
  vas_avo_net_x20_1:                           {num: vas_amount_net_x20_1,                den: vas_transactions_mnz_x20_1}
  vas_avo_net_x20_7:                           {num: vas_amount_net_x20_7,                den: vas_transactions_mnz_x20_7}
  vas_avo_net_highlight:                       {num: vas_amount_net_highlight,            den: vas_transactions_highlight}
  vas_avo_net_xl:                              {num: vas_amount_net_xl,                   den: vas_transactions_xl}
  vas_avo_net_bundle_mid:                      {num: vas_amount_net_bundle_mid,           den: vas_transactions_mnz_bundle_mid}
  vas_avo_net_bundle_max:                      {num: vas_amount_net_bundle_max,           den: vas_transactions_mnz_bundle_max}
#avo_net  start_date
  vas_avo_net_start_date:                                 {num: vas_amount_net_start_date,                      den: vas_transactions_start_date}
  vas_avo_net_visual_start_date:                          {num: vas_amount_net_visual_start_date,               den: vas_transactions_visual_start_date}
  vas_avo_net_performance_start_date:                     {num: vas_amount_net_performance_start_date,          den: vas_transactions_performance_start_date}
  vas_avo_net_bundle_start_date:                          {num: vas_amount_net_bundle_start_date,               den: vas_transactions_bundle_start_date}
  vas_avo_net_highlight_start_date:                       {num: vas_amount_net_highlight_start_date,            den: vas_transactions_highlight_start_date}
  vas_avo_net_xl_start_date:                              {num: vas_amount_net_xl_start_date,                   den: vas_transactions_xl_start_date}
  
  
