definitions:

  - &is_target_chat        {is_target_chat.=: 1}
  - &is_prob035            {sum_probability.>=: 0.35}
  - &is_lead_class         {class.in: [3, 4, 5]}


metric.counter:
    target_contact_chat_inbox:                           {filter: [* is_target_chat]}
    target_contact_chat_prob35_inbox:                    {filter: [*is_prob035]}
    target_contact_chat_class_inbox:                     {filter: [*is_lead_class]}

metric.uniq: 
  user_target_contact_chat_inbox:                        {counter: target_contact_chat_inbox,            key: [user]}
  user_target_contact_chat_prob35_inbox:                 {counter: target_contact_chat_prob35_inbox,     key: [user]}
  user_target_contact_chat_class_inbox:                  {counter: target_contact_chat_class_inbox,      key: [user]}