definitions:
   - &call                                              [iac, ct]

   - &is_trash                                         {type: trash}
   - &is_preliminary                                   {type: preliminary}
   - &is_target                                        {type: target}
   - &is_messenger                                     {contact_type: messenger}
   - &is_iac                                           {contact_type: iac}
   - &is_ct                                            {contact_type: ct}
   - &is_call                                          {contact_type: *call}

        
metric.counter:
  target_contact_all:                                   {filter: [{is_target: True}]}
  trash_contact:                                        {filter: [*is_trash]}
  preliminary_contact:                                  {filter: [*is_preliminary]}
  trash_contact_chat:                                   {filter: [*is_trash, *is_messenger]}
  preliminary_contact_chat:                             {filter: [*is_preliminary, *is_messenger]}
  trash_contact_call:                                   {filter: [*is_trash, *is_call]}
  preliminary_contact_call:                             {filter: [*is_preliminary, *is_call]}
  trash_contact_iac:                                    {filter: [*is_trash, *is_iac]}
  preliminary_contact_iac:                              {filter: [*is_preliminary, *is_iac]}
  trash_contact_ct:                                     {filter: [*is_trash, *is_ct]}
  preliminary_contact_ct:                               {filter: [*is_preliminary, *is_ct]}
  call_delivery_agreement:                              {filter: [{tags.ilike: ' delivery_agreement %'} , *is_call]}
  call_sending_docs:                                    {filter: [{tags.ilike: ' sending_docs %'} , *is_call]}
  call_item_deal_discussion:                            {filter: [{tags.ilike: ' item_deal_discussion %'} , *is_call]}
  call_agent_call:                                      {filter: [{tags.ilike: ' agent_call %'} , *is_call]}
  call_refused_by_employer:                             {filter: [{tags.ilike: ' refused_by_employer %'} , *is_call]}
  call_call_later_no_meeting:                           {filter: [{tags.ilike: ' call_later_no_meeting %'} , *is_call]}
  call_mistake:                                         {filter: [{tags.ilike: ' mistake %'} , *is_call]}
  call_different_number:                                {filter: [{tags.ilike: ' different_number %'} , *is_call]}
  call_dispatcher_call:                                 {filter: [{tags.ilike: ' dispatcher_call %'} , *is_call]}
  call_meeting_moment:                                  {filter: [{tags.ilike: ' meeting_moment %'} , *is_call]}
  call_going_for_interview:                             {filter: [{tags.ilike: ' going_for_interview %'} , *is_call]}
  call_fast_hiring:                                     {filter: [{tags.ilike: ' fast_hiring %'} , *is_call]}
  call_spam:                                            {filter: [{tags.ilike: ' spam %'} , *is_call]}
  call_contact_exchange:                                {filter: [{tags.ilike: ' contact_exchange %'} , *is_call]}
  call_auto_ru:                                         {filter: [{tags.ilike: ' auto_ru %'} , *is_call]}
  call_discrimination:                                  {filter: [{tags.ilike: ' discrimination %'} , *is_call]}
  call_illegal_vacancy:                                 {filter: [{tags.ilike: ' illegal_vacancy %'} , *is_call]}
  call_unclear:                                         {filter: [{tags.ilike: ' unclear %'} , *is_call]}
  call_delivery_discussion:                             {filter: [{tags.ilike: ' delivery_discussion %'} , *is_call]}
  call_ask_for_resume:                                  {filter: [{tags.ilike: ' ask_for_resume %'} , *is_call]}
  call_applicant_refused:                               {filter: [{tags.ilike: ' applicant_refused %'} , *is_call]}
  call_different_offer:                                 {filter: [{tags.ilike: ' different_offer %'} , *is_call]}
  call_agreed_on_booking:                               {filter: [{tags.ilike: ' agreed_on_booking %'} , *is_call]}
  call_already_sold:                                    {filter: [{tags.ilike: ' already_sold %'} , *is_call]}
  call_irrelevant_applicant:                            {filter: [{tags.ilike: ' irrelevant_applicant %'} , *is_call]}
  call_autoreply:                                       {filter: [{tags.ilike: ' autoreply %'} , *is_call]}
  call_failed_call:                                     {filter: [{tags.ilike: ' failed_call %'} , *is_call]}
  call_failed_agreement:                                {filter: [{tags.ilike: ' failed_agreement %'} , *is_call]}
  call_closed_vacancy:                                  {filter: [{tags.ilike: ' closed_vacancy %'} , *is_call]}
  call_going_to_meet:                                   {filter: [{tags.ilike: ' going_to_meet %'} , *is_call]}

  chat_first_class:                                     {filter: [{tags.ilike: ' 1 %'} , *is_messenger]}
  chat_second_class:                                    {filter: [{tags.ilike: ' 2 %'} , *is_messenger]}
  chat_third_class:                                     {filter: [{tags.ilike: ' 3 %'} , *is_messenger]}
  chat_fourth_class:                                    {filter: [{tags.ilike: ' 4 %'} , *is_messenger]}
  chat_fifth_class:                                     {filter: [{tags.ilike: ' 5 %'} , *is_messenger]}
  chat_sixth_class:                                     {filter: [{tags.ilike: ' 6 %'} , *is_messenger]}
  chat_seventh_class:                                   {filter: [{tags.ilike: ' 7 %'} , *is_messenger]}
  chat_eighth_class:                                    {filter: [{tags.ilike: ' 8 %'} , *is_messenger]}




    

metric.uniq: 
  target_buyers_any:                                     {counter: target_contact_all,     key: [cookie]}
  user_target_contact:                                   {counter: target_contact_all,     key: [user]}
  target_contact_canonical:                              {counter: target_contact_all,      key: [logcat_item]}
  target_buyers_canonical:                               {counter: target_contact_all,      key: [cookie_logcat]}
