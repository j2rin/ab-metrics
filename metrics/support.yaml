metric.counter:
# TICKETS
# ---- BASE CHANNELS ---
  support_wizard_tickets_created:          {obs: [ticket_wizard_created]}
  support_agent_tickets_created:           {obs: [ticket_agent_created]}
  support_call_tickets_created:            {obs: [ticket_call_created]}
  support_email_tickets_created:           {obs: [ticket_email_created]}
  support_chats_created:                   {obs: [chats_created]}
  support_callcenter_calls:                {obs: [callcenter_calls]}
# --- COMBINING TOTAL ---
  support_email_wizard_tickets_created:    {obs: [ticket_email_created, ticket_wizard_created]}
  support_ticket_chat_platform:            {obs: [ticket_wizard_created, chats_created]}
  support_total_flow:                      {obs: [ticket_wizard_created, ticket_email_created, chats_created, callcenter_calls]}
# --- MODERATION ---
  support_hc_ticket_platform_fraud_templates: {obs: [ticket_platform_fraud_templates]}
  support_hc_ticket_platform_fraud_nodes:  {obs: [ticket_platform_fraud_nodes]}
  support_hc_ticket_platform_fraud_templates_nodes: {obs: [ticket_platform_fraud_templates_nodes]}
  ##
  support_hc_ticket_platform_block:           {obs: [ticket_platform_moder_block]}
  support_hc_ticket_platform_reject:           {obs: [ticket_platform_moder_reject]}
  support_hc_ticket_platform_moder:           {obs: [ticket_platform_moder_block, ticket_platform_moder_reject]}
  ##
  support_call_ticket_block:           {obs: [ticket_call_moder_block_created]}
  support_call_ticket_reject:           {obs: [ticket_call_moder_reject_created]}
  support_call_ticket_moder:           {obs: [ticket_call_moder_block_created, ticket_call_moder_reject_created]}
  ##
  support_chats_block:                   {obs: [chats_moder_block_created]}
  support_chats_reject:                   {obs: [chats_moder_reject_created]}
  support_chats_moder:                   {obs: [chats_moder_block_created, chats_moder_reject_created]}
  ##
  support_flow_block:                   {obs: [ticket_platform_moder_block, ticket_call_moder_block_created, chats_moder_block_created]}
  support_flow_reject:                   {obs: [ticket_platform_moder_reject, ticket_call_moder_reject_created, chats_moder_reject_created]}
  support_flow_moder:                   {obs: [ticket_platform_moder_block, ticket_call_moder_block_created, chats_moder_block_created, ticket_platform_moder_reject, ticket_call_moder_reject_created, chats_moder_reject_created]}
  ##
  support_ticket_reviews:           {obs: [ticket_reviews]}
  support_call_reviews:           {obs: [ticket_call_reviews]}
  support_chats_reviews:                   {obs: [chats_reviews]}
  support_flow_reviews:                  {obs: [ticket_reviews, ticket_call_reviews, chats_reviews]}
# --- EXTRA INFO ---
  cnt_tickets_problem_changed:             {obs: [tickets_problem_changed], m42: False}
 # --- Anonymous Number and Calltracking --- 
  support_flow_anonnumber_templates:         {obs: [ticket_anonnumber_templates, call_anonnumber_nodes, chat_anonnumber_templates]}
  support_flow_anonnumber_nodes:             {obs: [ticket_anonnumber_nodes, call_anonnumber_nodes, chat_anonnumber_nodes]}
  support_flow_calltracking_templates:       {obs: [ticket_calltracking_templates, call_calltracking_nodes]}
  support_flow_calltracking_nodes:           {obs: [ticket_calltracking_nodes, call_calltracking_nodes, chat_calltracking_nodes]}

metric.uniq:
  support_contacters:                      {counter: support_total_flow,   key: [participant]}

metric.ratio:
  support_ticket_with_changed_problem_rate: {num: cnt_tickets_problem_changed,     den: support_email_wizard_tickets_created}
  support_chat_from_flow_share:        {num: support_chats_created, den: support_total_flow}