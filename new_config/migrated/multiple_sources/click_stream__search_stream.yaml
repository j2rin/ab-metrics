metric.counter:
  cnt_booking_delivery_delivery_btn_fav_msg_msg_btn_ph_tot: {filter: {$or: [{<<: *is_booking}, {<<: *is_delivery}, {<<: *is_delivery_btn}, {<<: *is_fav}, {<<: *is_msg}, {<<: *is_msg_btn}, {<<: *is_ph_tot}]}}
  cnt_contacts:                            {filter: {$or: [{<<: *is_booking}, {<<: *is_delivery}, {<<: *is_msg}, {<<: [*is_ph, *is_ph_right]}, {<<: [*is_ph, *is_ph_top]}]}}
  cnt_sessions_active:                     {filter: {$or: [{<<: [*is_1p, *is_search]}, {<<: *is_booking}, {<<: *is_delivery}, {<<: *is_delivery_btn}, {<<: *is_fav}, {<<: *is_iv}, {<<: *is_msg}, {<<: *is_msg_btn}, {<<: *is_ph_tot}]}}
  cnt_sessions_c_0:                        {filter: {$or: [{<<: *is_booking}, {<<: *is_delivery}, {<<: *is_delivery_btn}, {<<: *is_msg}, {<<: *is_ph_tot}]}}
  cnt_users:                               {filter: {$or: [{<<: [*is_1p, *is_search, *noq]}, {<<: [*is_1p, *is_search, *q]}, {<<: *is_booking}, {<<: *is_delivery_btn}, {<<: *is_fav}, {<<: *is_iv}, {<<: *is_msg}, {<<: *is_ph_tot}]}}
  cnt_users_1plus_actions:                 {filter: {$or: [{<<: [*is_1p, *is_search, *noq]}, {<<: [*is_1p, *is_search, *q]}, {<<: *is_booking}, {<<: *is_delivery}, {<<: *is_delivery_btn}, {<<: *is_fav}, {<<: *is_iv}, {<<: *is_msg}, {<<: *is_ph_tot}]}}
  cnt_users_bt_click:                      {filter: {$or: [{<<: *is_booking}, {<<: *is_delivery}, {<<: *is_fav}, {<<: *is_msg}, {<<: *is_ph_tot}]}}
  contacts:                                {filter: {$or: [{<<: *is_booking}, {<<: *is_delivery}, {<<: *is_msg}, {<<: *is_ph_tot}]}}

metric.uniq:
  bt_clicks_grouped:                       {counter: btc_funnel_all,                  key: [item, user]}
  contacts_grouped:                        {counter: contacts,                        key: [item, user]}
  buyers:                                  {counter: contacts,                        key: [user]}
  unq_user_users:                          {counter: cnt_users,                       key: [user]}
  user_pv:                                 {counter: phone_views_total,               key: [user]}
  users_1plus_actions:                     {counter: cnt_users_1plus_actions,         key: [user]}
  users_2plus_actions:                     {counter: cnt_users_1plus_actions,         key: [user]}
  users_active_daily:                      {counter: cnt_users_1plus_actions,         key: [user]}
  users_bt_click_daily:                    {counter: cnt_users_bt_click,              key: [user]}
  sessions_active:                         {counter: cnt_sessions_active,             key: [user, session]}
  sessions_btc:                            {counter: cnt_booking_delivery_delivery_btn_fav_msg_msg_btn_ph_tot, key: [user, session]}
  sessions_c:                              {counter: cnt_sessions_c_0,                key: [user, session]}

metric.ratio:
  buyers_per_users:                        {num: buyers,                          den: users_active_daily}
  buyers_per_users_favorites:              {num: buyers,                          den: users_favorites}
  contacts_per_item_view:                  {num: cnt_contacts,                    den: item_views}
  contacts_total_vas_per_contacts:         {num: contacts_total_vas,              den: contacts}
  sessions_btc_per_active:                 {num: sessions_btc,                    den: sessions_active}
  sessions_c_per_active:                   {num: sessions_c,                      den: sessions_active}
  sessions_iv_per_active:                  {num: sessions_iv,                     den: sessions_active}
  user_fatal_error_per_users:              {num: users_fatal_app_errors,          den: unq_user_users}
  user_non_fatal_error_per_users:          {num: users_non_fatal_app_errors,      den: users_active_daily}
  users_bt_click_per_users:                {num: users_bt_click_daily,            den: users_active_daily}
  users_item_view_per_users:               {num: users_item_view_daily,           den: users_active_daily}

