SELECT  observation_date AS event_date,
	    CASE WHEN participant_type = 'visitor' THEN coalesce(participant_id, 0) END AS cookie_id,
  		CASE WHEN participant_type = 'user'    THEN coalesce(participant_id, 0) END AS user_id,
  		participant_id,participant_type,
		platform_id,
		app_pushes_prepared,
		browser_pushes_prepared,
		sms_prepared,
		notification_center_prepared,
		email_prepared,
		app_pushes_no_data,
		browser_pushes_no_data,
		sms_no_data,
		notification_center_no_data,
		email_no_data,
		app_pushes_to_provider,
		browser_pushes_to_provider,
		sms_to_provider,
		notification_center_to_provider,
		email_to_provider,
		app_pushes_to_receiver,
		browser_pushes_to_receiver,
		sms_delivered_to_receiver,
		notification_center_to_receiver,
		email_to_receiver,
		app_pushes_open,
		browser_pushes_open,
		sms_delivered_open,
		notification_center_open,
		email_open,
		app_pushes_action,
		browser_pushes_action,
		sms_delivered_action,
		notification_center_action,
		email_action,
  		app_pushes_rec_marketing_prepared,
		app_pushes_rec_marketing_no_data,
		app_pushes_rec_marketing_to_provider,
		app_pushes_rec_marketing_to_receiver,
		app_pushes_rec_marketing_open,
		app_pushes_rec_marketing_action,
		app_pushes_marketing_to_receiver,
		browser_pushes_marketing_to_receiver,
		sms_marketing_to_receiver,
		notification_center_marketing_to_receiver,
		email_marketing_to_receiver,
		app_pushes_rec_to_receiver,
		app_pushes_crm_to_receiver,
		notification_marketing_prepared,
		notification_marketing_no_data,
		notification_marketing_to_provider,
		notification_marketing_to_receiver,
		notification_marketing_open,
		notification_marketing_action,
		notification_rec_prepared,
		notification_rec_no_data,
		notification_rec_to_provider,
		notification_rec_to_receiver,
		notification_rec_open,
		notification_rec_action,
		notification_crm_prepared,
		notification_crm_no_data,
		notification_crm_to_provider,
		notification_crm_to_receiver,
		notification_crm_open,
		notification_crm_action,
        notifications_off_profile,
      notifications_on_profile,
      notifications_off_system,
      notifications_on_system,
      notifications_off_any,
      notifications_on_any,
      notifications_off_profile_push,
      notifications_on_profile_push,
      notifications_off_profile_email,
      notifications_on_profile_email,
      notifications_off_profile_messenger,
      notifications_on_profile_messenger,
      notifications_off_profile_push_avito_news,
      notifications_off_profile_push_messenger,
      notifications_off_profile_push_pro_notifications,
      notifications_off_profile_push_discount,
      notifications_off_profile_push_poll,
      notifications_off_profile_push_fav_sellers,
      notifications_off_profile_push_user_reviews,
      notifications_off_profile_push_delivery,
      notifications_off_profile_push_action,
      notifications_off_profile_push_recommendation,
      notifications_off_profile_push_tips,
      notifications_off_profile_push_messenger_reminder,
      notifications_off_profile_email_recommendation,
      notifications_off_profile_email_tips,
      notifications_off_profile_email_delivery,
      notifications_off_profile_email_fav_sellers,
      notifications_off_profile_email_messenger,
      notifications_off_profile_email_user_reviews,
      notifications_off_profile_email_action,
      notifications_off_profile_email_avito_news,
      notifications_off_profile_email_notification,
      notifications_off_profile_email_poll,
      notifications_off_profile_email_discount,
      notifications_off_profile_messenger_recommendation,
      notifications_off_profile_messenger_limit_calls,
      notifications_off_profile_messenger_discount,
      notifications_off_profile_messenger_avito_news,
      notifications_off_profile_messenger_tips,
      notifications_off_profile_messenger_user_reviews,
      notifications_off_profile_messenger_deal_confirmation,
      notifications_off_profile_messenger_action,
      notifications_off_profile_messenger_pro_notifications
FROM dma.notifications_metric_observation d
where observation_date::date between :first_date and :last_date
